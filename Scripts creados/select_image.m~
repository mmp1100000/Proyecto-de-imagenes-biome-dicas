function [I] = select_image()
%This function receives a directory and shows all the images inside it. Then, 
%when "scape" pressed, the function returns the image being viewed.


%%Turning off warnings
%[a,MSGID] = lastwarn()
warning('off','images:dicominfo:fileVRDoesNotMatchDictionary'); %Turn off Marco's programm warning
warning('off','MATLAB:nargchk:deprecated'); %Turn off getkey news
%%

%uigetdir creates a visual interface for selecting the images location

dicomlist = loadDicom(uigetdir);
cnt = 1;
key = 0;
info = dicominfo(dicomlist(cnt).file);
I = dicomread(info);
curImg = imshow(I,[],'InitialMagnification','fit');
while key ~= 27
    info = dicominfo(dicomlist(cnt).file);
    I = dicomread(info);
    set(curImg,'CData',I);
    title(strcat('Z:      ',num2str(round(dicomlist(cnt).pos))));
    key = getkey;
    %key = 29;
    if key ~= 27 && key ~= 28 && key ~= 29
        key = getkey;
    end
    
    if key == 29 && cnt ~= numel(dicomlist)
        cnt = cnt + 1;
        %pause(0.1);
    else
        if key == 28 && cnt ~= 1
            cnt = cnt - 1;
        end
    end  
end %Show images


end

